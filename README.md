Copied from the source code by Jon Barron: https://jonbarron.info/.